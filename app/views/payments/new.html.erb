<h1>Take a payment</h1>

<div class="col-md-6">
	<%= simple_form_for @payment, :url => payments_path  do |f| %>
		<div class="form-group <%= 'has-error' unless @payment.errors[:mandate_id].empty? %>">
			<%= label_tag(:mandate_id, 'Customer', class: 'control-label') %>
			<%= f.select :mandate_id, @mandates.map{ |m| [m.customer_name, m.gc_id]}, {}, { class: 'form-control', target: mandate_url(@mandate_selected.gc_id).sub(@mandate_selected.gc_id, '') } %>
			<%= f.error :mandate_id %>
		</div>
		<div class="form-group <%= 'has-error' unless @payment.errors[:amount].empty? %>">
			<label class="control-label" for="amount">Amount (<span id="payment_currency"><%= currency_symbol(@mandate_selected.currency) %></span>)</label>
			<%= f.text_field :amount, placeholder: 10, class: 'form-control' %>
			<%= f.error :amount %>
		</div>
		<div class="form-group <%= 'has-error' unless @payment.errors[:description].empty? %>">
			<%= label_tag(:description, 'Description', class: 'control-label') %>
			<%= f.text_field :description, placeholder: 'What is this payment for?', class: 'form-control' %>
			<%= f.error :description %>
		</div>
		<div class="form-group <%= 'has-error' unless @payment.errors[:reference].empty? %>">
			<%= label_tag(:reference, 'Reference', class: 'control-label') %>
			<%= f.text_field :reference, placeholder: 'This will appear on the customer bank statement', class: 'form-control' %>
			<%= f.error :reference %>
		</div>
		<div class="form-group <%= 'has-error' unless @payment.errors[:charge_date].empty? %>">
			<label class="control-label" for="charge_date">Take payment on (earliest <span id="next_possible_charge_date"><%= @next_possible_charge_date.to_date.strftime('%d/%m/%Y') %></span>)</label>
			<%= f.date_field :charge_date, value: @payment.charge_date || @next_possible_charge_date, class: 'form-control' %>
			<%= f.error :charge_date %>
		</div>
		<div class="row">
			<div class="col-xs-4 no-padding-left">
				<a href="<%= reporting_payments_path %>" class="btn btn-default btn-block col-xs-4">Cancel</a>
			</div>
			<div class="col-xs-8 no-padding-right">
				<button type="submit" class="btn btn-primary btn-block"><%= t('filters.form.submit') %></button>
			</div>
		</div>
	<% end %>
</div>