<% provide(:title, t('.h1')) %>
<div class="row">
	<div class="col-sm-9"><h1><%= t('.h1') %></h1></div>
	<div class="col-sm-3"><%= link_to t('.link_export'), reporting_mandates_path(format: :csv), class: 'btn pop pull-right h1-btn' %></div>
</div>

<% if !current_user.recent_update? %>
	<%= render partial: 'reporting/loading' %>
<% end %>

	<form action="<%= reporting_mandates_path %>" method="get" class="form-inline">
		<div class="form-group">
			<p class='form-control-static'><%= t('filters.time.label_created') %></p>
		</div>
		<div class="form-group">
			<%= select_tag(:time_filter, options_for_select(Mandate.time_filters, @time_filter), class: 'form-control') %>
		</div>
		<button type="submit" class="btn btn-primary"><%= t('filters.form.submit') %></button>
	</form>

	<table class="table" id="results">
		<th><%= t('.table_title_creation_date') %></th>
		<th><%= t('.table_title_customer_id') %></th>
		<th><%= t('.table_title_mandate_id') %></th>
		<th><%= t('.table_title_customer') %></th>
		<th><%= t('.table_title_mandate_scheme') %></th>
		<th><%= t('.table_title_mandate_status') %></th>
		<% if !@mandates.nil? and @mandates.any? %>
			<%= render partial: 'reporting/mandate', collection: @mandates %>
		<% end %>
	</table>
	<% if !@mandates.nil? and @mandates.any? %>
		<div id="infinite-scrolling-mandates">
			<%= will_paginate @mandates %>
		</div>
	<% else %>
		<p><%= t('.no_mandates') %></p>
	<% end %>